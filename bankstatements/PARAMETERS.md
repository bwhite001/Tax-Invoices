# bankstatements - Parameters Reference

Complete parameter documentation for the bankstatements module.

---

## üìã Table of Contents

- [Overview](#overview)
- [Script Parameters](#script-parameters)
- [Categorization Rules](#categorization-rules)
- [File Paths](#file-paths)
- [Processing Configuration](#processing-configuration)
- [Examples](#examples)

---

## üéØ Overview

The bankstatements module consists of 6 scripts that process bank statements in sequence. Each script has its own parameters.

**Workflow**:
1. `prepare_files.py` - Add zip_ prefix
2. `zip_money_extractor.py` - Extract transactions
3. `remove_duplicates.py` - Remove duplicates
4. `run_cataloger.py` - Categorize expenses
5. `fix_categorization.py` - Fix categories
6. `organize_outputs.py` - Organize by FY

---

## üìù Script Parameters

### 1. prepare_files.py

#### source_dir

```python
source_dir = "Statements/FY2024-2025"
```

- **Type**: String (directory path)
- **Default**: `"Statements/FY2024-2025"`
- **Description**: Source directory for bank statement PDFs
- **Required**: Yes
- **Example**: `"Statements/FY2024-2025"`

**When to change**:
- Different financial year
- Custom directory structure
- **MUST UPDATE** for each new financial year

**Location in file**: Line ~10

#### temp_dir

```python
temp_dir = "temp_processing"
```

- **Type**: String (directory path)
- **Default**: `"temp_processing"`
- **Description**: Temporary processing directory
- **Required**: Yes
- **Auto-created**: Yes

**When to change**:
- Custom temp location
- Rarely needs changing

**Location in file**: Line ~11

#### prefix

```python
prefix = "zip_"
```

- **Type**: String
- **Default**: `"zip_"`
- **Description**: Prefix to add to filenames
- **Required**: Yes
- **Purpose**: Identifies Zip Money statements

**When to change**:
- Different bank (e.g., "suncorp_", "beyond_")
- Custom identification
- Usually keep as "zip_"

**Location in file**: Line ~12

---

### 2. zip_money_extractor.py

#### input_dir

```python
input_dir = "temp_processing"
```

- **Type**: String (directory path)
- **Default**: `"temp_processing"`
- **Description**: Directory with prefixed PDFs
- **Required**: Yes
- **Must match**: temp_dir from prepare_files.py

**When to change**:
- Custom temp directory
- Must match prepare_files.py setting

**Location in file**: Line ~15

#### output_file

```python
output_file = "zip_transactions.csv"
```

- **Type**: String (filename)
- **Default**: `"zip_transactions.csv"`
- **Description**: Output CSV filename
- **Required**: Yes

**When to change**:
- Custom output name
- Multiple banks (e.g., "suncorp_transactions.csv")

**Location in file**: Line ~16

---

### 3. remove_duplicates.py

#### input_file

```python
input_file = "zip_transactions.csv"
```

- **Type**: String (filename)
- **Default**: `"zip_transactions.csv"`
- **Description**: Input CSV with transactions
- **Required**: Yes
- **Must match**: output_file from zip_money_extractor.py

**When to change**:
- Custom input name
- Must match extractor output

**Location in file**: Line ~10

#### output_file

```python
output_file = "zip_transactions.csv"
```

- **Type**: String (filename)
- **Default**: `"zip_transactions.csv"` (overwrites input)
- **Description**: Output CSV filename
- **Required**: Yes

**When to change**:
- Keep separate files
- Usually overwrites input

**Location in file**: Line ~11

---

### 4. run_cataloger.py

#### input_file

```python
input_file = "zip_transactions.csv"
```

- **Type**: String (filename)
- **Default**: `"zip_transactions.csv"`
- **Description**: Input CSV with deduplicated transactions
- **Required**: Yes

**When to change**:
- Custom input name
- Must match remove_duplicates.py output

**Location in file**: Line ~10

---

### 5. fix_categorization.py

#### input_file

```python
input_file = "expense_catalog.csv"
```

- **Type**: String (filename)
- **Default**: `"expense_catalog.csv"`
- **Description**: Catalog file to fix
- **Required**: Yes
- **Generated by**: run_cataloger.py

**When to change**:
- Custom catalog name
- Rarely needs changing

**Location in file**: Line ~10

---

### 6. organize_outputs.py

#### source_dir

```python
source_dir = "extracted"
```

- **Type**: String (directory path)
- **Default**: `"extracted"`
- **Description**: Source directory with processed files
- **Required**: Yes

**When to change**:
- Custom output directory
- Rarely needs changing

**Location in file**: Line ~10

#### fy_dir

```python
fy_dir = "FY2024-2025"
```

- **Type**: String (directory path)
- **Default**: `"FY2024-2025"`
- **Description**: Financial year directory
- **Required**: Yes
- **MUST UPDATE** for each new financial year

**When to change**:
- Different financial year
- **CRITICAL**: Update for each new FY

**Location in file**: Line ~11

#### output_base

```python
output_base = "Processed/BankStatements"
```

- **Type**: String (directory path)
- **Default**: `"Processed/BankStatements"`
- **Description**: Output base directory
- **Required**: Yes

**When to change**:
- Custom output structure
- Rarely needs changing

**Location in file**: Line ~12

---

## üè∑Ô∏è Categorization Rules

### expense_cataloger.py

#### CATEGORIES

```python
CATEGORIES = {
    'Shopping': ['amazon', 'temu', 'ebay', 'kmart', 'target', ...],
    'Dining': ['restaurant', 'cafe', 'mcdonald', 'kfc', ...],
    'Entertainment': ['steam', 'netflix', 'spotify', ...],
    'Banking': ['fee', 'charge', 'interest', ...],
    'Transfer': ['bpay', 'transfer', 'payment', ...],
    'Transport': ['uber', 'fuel', 'petrol', ...],
    'Utilities': ['electricity', 'gas', 'water', ...],
    'Income': ['refund', 'credit', 'return', ...],
    'Other': []  # Catch-all
}
```

- **Type**: Dictionary of category names to keyword lists
- **Default**: 9 predefined categories
- **Description**: Rules for automatic categorization
- **Required**: Yes
- **Customizable**: Yes

**When to change**:
- Add new categories
- Add new keywords
- Customize for your spending patterns

**Location in file**: `expense_cataloger.py`, Line ~20

### Adding Custom Categories

```python
CATEGORIES = {
    # Existing categories...
    'Shopping': ['amazon', 'temu', 'ebay'],
    
    # Add new category
    'Healthcare': ['pharmacy', 'chemist', 'doctor', 'medical'],
    
    # Add new category
    'Education': ['udemy', 'coursera', 'university', 'textbook'],
}
```

### Adding Keywords to Existing Categories

```python
CATEGORIES = {
    'Shopping': [
        'amazon', 'temu', 'ebay',
        # Add your frequent stores
        'costco', 'bunnings', 'officeworks'
    ],
    'Dining': [
        'restaurant', 'cafe',
        # Add your favorite places
        'subway', 'dominos', 'guzman'
    ],
}
```

---

## üìÇ File Paths

### Input Paths

```
Statements/
‚îî‚îÄ‚îÄ FY2024-2025/
    ‚îú‚îÄ‚îÄ statement_01.pdf
    ‚îú‚îÄ‚îÄ statement_02.pdf
    ‚îî‚îÄ‚îÄ statement_03.pdf
```

**Requirements**:
- PDFs in `Statements/FY{year}/` folder
- Any naming convention
- Text-based PDFs (not scanned)

### Intermediate Paths

```
temp_processing/
‚îú‚îÄ‚îÄ zip_statement_01.pdf
‚îú‚îÄ‚îÄ zip_statement_02.pdf
‚îî‚îÄ‚îÄ zip_statement_03.pdf

zip_transactions.csv
```

**Auto-created**:
- temp_processing/ folder
- zip_transactions.csv file

### Output Paths

```
FY2024-2025/
‚îî‚îÄ‚îÄ Processed/
    ‚îî‚îÄ‚îÄ BankStatements/
        ‚îî‚îÄ‚îÄ ZipMoney_20241215_143022/
            ‚îú‚îÄ‚îÄ expense_catalog.xlsx
            ‚îú‚îÄ‚îÄ expense_catalog.csv
            ‚îú‚îÄ‚îÄ monthly_expenses_by_category.csv
            ‚îú‚îÄ‚îÄ category_Shopping.csv
            ‚îú‚îÄ‚îÄ category_Dining.csv
            ‚îú‚îÄ‚îÄ ... (9 category files)
            ‚îú‚îÄ‚îÄ PROCESSING_SUMMARY.md
            ‚îî‚îÄ‚îÄ CROSS_REFERENCE_MAPPING.md
```

**Auto-created**:
- All directories
- All output files
- Timestamped folder

---

## ‚öôÔ∏è Processing Configuration

### Duplicate Detection

**Method**: Exact match on:
- Date
- Description
- Amount

**Configuration**: None (automatic)

**Behavior**:
- Keeps first occurrence
- Removes subsequent duplicates
- Logs removed count

### Date Parsing

**Supported Formats**:
- `DD/MM/YYYY` (e.g., 15/12/2024)
- `YYYY-MM-DD` (e.g., 2024-12-15)
- `DD-MM-YYYY` (e.g., 15-12-2024)

**Configuration**: Automatic detection

### Amount Parsing

**Formats**:
- `$123.45` - Positive (income/credit)
- `-$123.45` - Negative (expense)
- `123.45` - Positive
- `-123.45` - Negative

**Configuration**: Automatic parsing

---

## üìù Examples

### Example 1: Standard Configuration (FY2024-2025)

```python
# prepare_files.py
source_dir = "Statements/FY2024-2025"
temp_dir = "temp_processing"
prefix = "zip_"

# organize_outputs.py
fy_dir = "FY2024-2025"
output_base = "Processed/BankStatements"
```

**Use case**: Current financial year

### Example 2: New Financial Year (FY2025-2026)

```python
# prepare_files.py
source_dir = "Statements/FY2025-2026"  # UPDATE

# organize_outputs.py
fy_dir = "FY2025-2026"  # UPDATE
```

**Use case**: Start of new financial year

### Example 3: Custom Categories

```python
# expense_cataloger.py
CATEGORIES = {
    'Shopping': ['amazon', 'temu', 'ebay', 'kmart'],
    'Dining': ['restaurant', 'cafe', 'mcdonald'],
    'Entertainment': ['steam', 'netflix', 'spotify'],
    'Banking': ['fee', 'charge'],
    'Transfer': ['bpay', 'transfer'],
    'Transport': ['uber', 'fuel'],
    'Utilities': ['electricity', 'gas'],
    'Income': ['refund', 'credit'],
    
    # Add custom categories
    'Healthcare': ['pharmacy', 'chemist', 'doctor'],
    'Education': ['udemy', 'coursera', 'university'],
    'Subscriptions': ['adobe', 'microsoft', 'github'],
    
    'Other': []
}
```

**Use case**: Custom spending categories

### Example 4: Multiple Banks

```python
# For Zip Money
# prepare_files.py
prefix = "zip_"
# zip_money_extractor.py
output_file = "zip_transactions.csv"

# For Suncorp (if processing separately)
# prepare_files.py
prefix = "suncorp_"
# extractor script
output_file = "suncorp_transactions.csv"
```

**Use case**: Processing multiple banks

### Example 5: Custom Output Location

```python
# organize_outputs.py
source_dir = "extracted"
fy_dir = "FY2024-2025"
output_base = "Reports/Banking"  # Custom location
```

**Use case**: Different output structure

---

## üîß Parameter Validation

### Financial Year Format

```python
# Valid
"FY2024-2025"  ‚úì
"FY2023-2024"  ‚úì

# Invalid
"FY24-25"      ‚úó Must be full year
"2024-2025"    ‚úó Must have FY prefix
```

### File Paths

```python
# Valid
"Statements/FY2024-2025"  ‚úì
"temp_processing"          ‚úì

# Warning
"Statements/FY2024-25"    ‚ö†Ô∏è Inconsistent format
"/nonexistent/path"        ‚ö†Ô∏è Will be created
```

### Category Keywords

```python
# Valid
['amazon', 'ebay', 'temu']  ‚úì

# Warning
['Amazon', 'eBay']          ‚ö†Ô∏è Case-sensitive, use lowercase
[]                          ‚ö†Ô∏è Empty list, no matches
```

---

## üîÑ Workflow Parameters

### Complete Workflow

```bash
# 1. Prepare files
python bankstatements/prepare_files.py
# Uses: source_dir, temp_dir, prefix

# 2. Extract transactions
python bankstatements/zip_money_extractor.py
# Uses: input_dir, output_file

# 3. Remove duplicates
python bankstatements/remove_duplicates.py
# Uses: input_file, output_file

# 4. Categorize
python bankstatements/run_cataloger.py
# Uses: input_file, CATEGORIES

# 5. Fix categories (optional)
python bankstatements/fix_categorization.py
# Uses: input_file

# 6. Organize outputs
python bankstatements/organize_outputs.py
# Uses: source_dir, fy_dir, output_base
```

---

## üí° Tips & Best Practices

### Financial Year Updates

**At start of new FY**:
1. Update `source_dir` in prepare_files.py
2. Update `fy_dir` in organize_outputs.py
3. Create new `Statements/FY{year}/` folder

### Category Customization

**Best practices**:
- Use lowercase keywords
- Add specific merchant names
- Test with sample data
- Review uncategorized items

### File Organization

**Recommended structure**:
```
Tax Invoices/
‚îú‚îÄ‚îÄ Statements/
‚îÇ   ‚îú‚îÄ‚îÄ FY2023-2024/
‚îÇ   ‚îú‚îÄ‚îÄ FY2024-2025/
‚îÇ   ‚îî‚îÄ‚îÄ FY2025-2026/
‚îú‚îÄ‚îÄ FY2024-2025/
‚îÇ   ‚îî‚îÄ‚îÄ Processed/
‚îÇ       ‚îî‚îÄ‚îÄ BankStatements/
‚îî‚îÄ‚îÄ bankstatements/
    ‚îî‚îÄ‚îÄ (scripts)
```

---

## ‚ö†Ô∏è Common Issues

### Issue: "No files found"

**Solution**:
```python
# Check source_dir path
source_dir = "Statements/FY2024-2025"
# Verify PDFs exist in this folder
```

### Issue: "No transactions extracted"

**Solution**:
- Check PDF format (text-based, not scanned)
- Verify "zip_" prefix was added
- Check PDF content manually

### Issue: "Wrong categories"

**Solution**:
```python
# Add keywords to CATEGORIES
CATEGORIES = {
    'Shopping': [
        'amazon', 'temu',
        'your-store-name'  # Add this
    ]
}
```

### Issue: "Duplicate transactions"

**Solution**:
- Run remove_duplicates.py again
- Check if same statement processed twice
- Verify date/amount/description matching

---

## üìö Related Documentation

- **[README.md](README.md)** - Module overview
- **[QUICKSTART.md](QUICKSTART.md)** - Quick start guide
- **[../MODULE_INDEX.md](../MODULE_INDEX.md)** - All modules

---

## üîÑ Annual Update Checklist

At the start of each financial year:

- [ ] Create new `Statements/FY{year}/` folder
- [ ] Update `source_dir` in prepare_files.py
- [ ] Update `fy_dir` in organize_outputs.py
- [ ] Test with one statement
- [ ] Process all statements
- [ ] Review categorization
- [ ] Update keywords if needed

---

*Last Updated: December 2024*  
*Version: 1.0*
